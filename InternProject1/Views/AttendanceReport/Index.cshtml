@model IEnumerable<InternProject1.Models.StaffSummaryViewModel>

@{
    // Dynamically calculate totals for the summary cards
    var totalAttendance = Model?.Sum(s => s.AttendanceCount) ?? 0;
    var totalLate = Model?.Sum(s => s.LateCount) ?? 0;
    var totalLeave = Model?.Sum(s => s.LeaveCount) ?? 0;
    var totalAbsent = Model?.Sum(s => s.AbsentCount) ?? 0;
}

<div class="container-fluid p-0" style="background-color: #f8f9fa; min-height: 100vh;">
    @* Top Header Section *@
    <div class="text-center py-3 mb-4" style="background-color: #BDD2E7; border-bottom: 2px solid #a5bed9;">
        <h5 class="fw-bold m-0" style="text-decoration: underline; text-underline-offset: 5px;">Attendance Report</h5>
        <small class="fw-bold">2026 / Jan</small>
    </div>

    <div class="px-4">
        @* Summary Statistics Cards - Now Auto-Calculated *@
        <div class="row g-3 mb-5 justify-content-center text-center">
            <div class="col-md-2">
                <div class="p-3 rounded-4 shadow-sm" style="background-color: #DDE7F2; border-radius: 15px !important;">
                    <p class="small fw-bold mb-1" style="font-size: 0.75rem;">Total Attendance</p>
                    <h2 class="fw-bold m-0">@totalAttendance</h2>
                </div>
            </div>
            <div class="col-md-2">
                <div class="p-3 rounded-4 shadow-sm" style="background-color: #DDE7F2; border-radius: 15px !important;">
                    <p class="small fw-bold mb-1" style="font-size: 0.75rem;">Total Days Late</p>
                    <h2 class="fw-bold m-0">@totalLate</h2>
                </div>
            </div>
            <div class="col-md-2">
                <div class="p-3 rounded-4 shadow-sm" style="background-color: #DDE7F2; border-radius: 15px !important;">
                    <p class="small fw-bold mb-1" style="font-size: 0.75rem;">Total Days Of Leave</p>
                    <h2 class="fw-bold m-0">@totalLeave</h2>
                </div>
            </div>
            <div class="col-md-2">
                <div class="p-3 rounded-4 shadow-sm" style="background-color: #DDE7F2; border-radius: 15px !important;">
                    <p class="small fw-bold mb-1" style="font-size: 0.75rem;">Total Absences</p>
                    <h2 class="fw-bold m-0">@totalAbsent</h2>
                </div>
            </div>
        </div>

        @* Employee Data Table *@
        <div class="card border-0 shadow-sm overflow-hidden" style="border-radius: 8px;">
            <table class="table align-middle text-center mb-0">
                <thead style="background-color: #4A77A5; color: white;">
                    <tr class="small fw-bold">
                        <th class="py-3 text-start ps-4">Employee Name</th>
                        <th>Attendance</th>
                        <th>Late</th>
                        <th>Leave</th>
                        <th>Absent</th>
                        <th>Overtime</th>
                    </tr>
                </thead>
                <tbody class="bg-white">
                    @if (Model != null && Model.Any())
                    {
                        @foreach (var staff in Model)
                        {
                            <tr class="border-bottom">
                                <td class="py-3 fw-semibold text-start ps-4" style="color: #4A77A5;">@staff.Name</td>
                                <td class="text-secondary">@staff.AttendanceCount</td>
                                <td class="text-secondary">@staff.LateCount</td>
                                <td class="text-secondary">@staff.LeaveCount</td>
                                <td class="text-secondary">@staff.AbsentCount</td>
                                <td class="text-secondary">@staff.OvertimeCount</td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="6" class="py-5 text-muted">No attendance records found for this period.</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        @* Export Actions *@
        <div class="text-end mt-4 d-flex flex-column align-items-end gap-2">
            <a asp-controller="AttendanceReport" asp-action="ExportToExcel" class="btn btn-sm px-4 shadow-sm"
               style="background-color: #DDE7F2; border-radius: 10px; font-weight: 500; font-size: 0.85rem; border: none; color: black; text-decoration: none;">
                Convert To Excel
            </a>
            <a asp-controller="AttendanceReport" asp-action="ExportToPdf" class="btn btn-sm px-4 shadow-sm"
               style="background-color: #DDE7F2; border-radius: 10px; font-weight: 500; font-size: 0.85rem; border: none; color: black; text-decoration: none;">
                Convert To PDF
            </a>
        </div>
    </div>
</div>